{% extends 'base.html' %}
{% block title %}Dashboard Ciudadano{% endblock %}
{% block content %}

<div class="container mt-4">

  <!-- Bienvenida -->
  <div class="alert alert-primary text-center shadow-sm">
    <h3 class="mb-1">âš¡ Bienvenido a tu espacio ciudadano en ServiTracker</h3>
    <p class="mb-0">AquÃ­ puedes gestionar tus PQR y acceder a informaciÃ³n de ESSA.</p>
  </div>

  <!-- Resumen de PQR -->
  <div class="row text-center mb-4">
    <div class="col-md-4">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title text-warning">ğŸ“Œ PQR Abiertas</h5>
          <p class="display-6">{{ quejas|length }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title text-info">â³ En Proceso</h5>
          <p class="display-6">{{ quejas|dictsort:"estado.nombre"|length }}</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm border-0">
        <div class="card-body">
          <h5 class="card-title text-success">âœ… Cerradas</h5>
          <p class="display-6">
            {{ quejas|dictsort:"estado.nombre"|length }}
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- BotÃ³n nueva PQR -->
  <div class="text-end mb-3">
    <a href="{% url 'crear_queja' %}" class="btn btn-primary">â• Nueva PQR</a>
  </div>

  <!-- Tabla de PQR -->
  <h4 class="mb-3">Mis PQR</h4>
  <table class="table table-striped table-bordered shadow-sm">
    <thead class="table-warning">
      <tr>
        <th>ID</th>
        <th>Tipo de Falla</th>
        <th>Estado</th>
        <th>Fecha</th>
      </tr>
    </thead>
    <tbody>
      {% for q in quejas %}
      <tr>
        <td>{{ q.id }}</td>
        <td>{{ q.tipo_falla.nombre }}</td>
        <td>{{ q.estado.nombre }}</td>
        <td>{{ q.fecha_reporte|date:"d/m/Y H:i" }}</td>
      </tr>
      {% empty %}
      <tr><td colspan="4">No tienes PQR registradas.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Servicios ESSA -->
  <h4 class="mt-5 mb-3">Servicios de ESSA</h4>
  <div class="row g-4">
    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <h5 class="card-title">ğŸ’¡ EnergÃ­a Hogar</h5>
          <p class="card-text">Confiabilidad y calidad en el suministro elÃ©ctrico para tu familia.</p>
          <a href="https://www.essa.com.co/site/clientes/hogar" target="_blank" class="btn btn-sm btn-outline-primary">Ver mÃ¡s</a>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <h5 class="card-title">ğŸ¢ EnergÃ­a Empresas</h5>
          <p class="card-text">Soluciones energÃ©ticas para el crecimiento de tu negocio.</p>
          <a href="https://www.essa.com.co/site/clientes/empresas" target="_blank" class="btn btn-sm btn-outline-primary">Ver mÃ¡s</a>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <h5 class="card-title">ğŸ“„ FacturaciÃ³n</h5>
          <p class="card-text">Consulta tu factura y puntos de pago disponibles.</p>
          <a href="https://www.essa.com.co/site/mi-factura" target="_blank" class="btn btn-sm btn-outline-primary">Ver mÃ¡s</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Preguntas frecuentes -->
  <h4 class="mt-5 mb-3">Preguntas Frecuentes</h4>
  <div class="accordion" id="faqAccordion">
    <div class="accordion-item">
      <h2 class="accordion-header" id="faq1">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">
          Â¿CÃ³mo reporto una falla de energÃ­a?
        </button>
      </h2>
      <div id="collapse1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
        <div class="accordion-body">
          Puedes reportar fallas llamando al <strong>115</strong> o a la lÃ­nea gratuita <strong>01 8000 971 903</strong>.
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="faq2">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">
          Â¿DÃ³nde puedo pagar mi factura?
        </button>
      </h2>
      <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
        <div class="accordion-body">
          Puedes pagar en bancos autorizados, corresponsales bancarios o en lÃ­nea desde la pÃ¡gina oficial de ESSA.
        </div>
      </div>
    </div>
    <div class="accordion-item">
      <h2 class="accordion-header" id="faq3">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">
          Â¿CÃ³mo solicito una nueva conexiÃ³n de energÃ­a?
        </button>
      </h2>
      <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
        <div class="accordion-body">
          EnvÃ­a tu solicitud al correo <strong>conexiones@essa.com.co</strong> o acÃ©rcate a una oficina de atenciÃ³n.
        </div>
      </div>
    </div>
  </div>

  <!-- Canales de atenciÃ³n -->
  <h4 class="mt-5 mb-3">Canales de AtenciÃ³n</h4>
  <ul class="list-group shadow-sm">
    <li class="list-group-item">ğŸ“ LÃ­nea gratuita: 01 8000 971 903</li>
    <li class="list-group-item">âš¡ Reporte de daÃ±os y emergencias: 115</li>
    <li class="list-group-item">ğŸ’¬ WhatsApp empresarial: 318 833 91 21</li>
    <li class="list-group-item">ğŸ“§ Correo: essa@essa.com.co</li>
  </ul>

</div>
{% endblock %}
